<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3362 -- 20-Four</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3362></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3362&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">20-Four</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 89</td><td width="10px"></td><td><b>Accepted:</b> 12</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>The following scenario takes place between 8:00AM and 9:00AM. In the headquarters of the Counter Terrorist Agency (CTA), you are tasked to aid Jack prevent the next terror attack. The CTA has been tracking the terrorists for over a week. It was discovered that the terrorists operate in separate independent groups. Each group carries a specific chemical which is harmless by itself. Though it is not readily available, possession of such chemical even in huge quantity is not illegal. Thus these groups cannot be apprehended even if they are spotted in possession of the chemical. However, if the groups meet in the same city, they can mix the chemical that they have at hand and form a nerve agent, which they can release within the next hour.</p><p>To track down and prevent the next attack, it was determined that all groups move independently of each other using forward then left protocol in 16 cities as shown in Figure 3. The protocol means forward to the next city followed by the city on the left. In the case when there is no city in front, the group heads to the next city to the left. If there is no city to the left, the group backtracks to the previous city. In both cases, the move in the protocol is skipped, as it is replaced by the alternate movement. If there are no cities to backtrack into, (e.g. if there is no information on its previous location) the group stay put in the city and simply wait it out.</p><p><center><img src="images/3362_1.GIF"></img></center></p><p><center>Figure 3: Map of 16 cities that all terror groups move about and a group starting at 4,3 with a <i>left</i>.</center></p><p>The attack is carried out only when all groups meet in the same city. Figure 3 illustrates a map of the cities, where each city is labelled using <i>x</i>, <i>y</i> coordinates. Moving forward implies maintaining the same direction from previous to current. For example, if the group is currently at city 3,3 and previously at 4,3 moving forward means going to 2,3, if the group is previously at 3,4, then the group moves to 3,2; if the group is previously at 2,3, then it proceeds to 4,3 and if previously at 3,2, the group goes to 3,4.</p><p>A <i>left</i> implies moving counterclockwise based on the current and previous location. For example, if the group is currently at city 3,3 and previously at 4,3 moving left means going to 3,4; if the group is previously at 3,4 then the group goes to 2,3; if the group is previously at 3,2, the group moves to 4,3; and if the groups is previously at 2,3, it proceeds to 3,2.</p><p>It was also learned that all groups can move from one city to the next city in exactly 20 minutes. Since the group cannot be apprehended if they are carrying only the single chemical, they have to be apprehended in the act of preparing the nerve agent. Since you lack man power to track all groups simultaneously, you are tasked to determine the time and place all groups will meet to prepare the nerve agent.</p><p>Satellite tracking can only show the whereabouts of each group at the start of the hour. Time is running out fast. When and where should you send Jack to take down these terror groups? However, if all groups were not able to meet within 24 hours, the threat alert level is dropped, as the terrorist will disband and decide on the next attack sometime in the future.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input will contain several test cases. The first line will indicate the number of test cases. Each test case starts with the number of terror groups moving about the 16 cities. Then it is followed by the coordinate values <i>x</i> and <i>y</i> of each group taken at the start of the hour followed by the next direction either forward (F) or left (L) that they will be initially moving. For the initial movement, we will assume that a <i>forward</i> is a decrease in the <i>y</i> coordinate and a left is a decrease in the <i>x</i> coordinate value.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>The output must show in which city all the groups will meet and the time (24-hour time format) in which Jack must be situated to take down the terrorist. Otherwise, it outputs a plain text stating "no terror threat" if the groups do not converge within 24 hours.</p></div><p class="pst">Sample Input</p><pre class="sio">1 
2 
2, 3, F 
3, 4, F</pre><p class="pst">Sample Output</p><pre class="sio">Case 1: 1, 3, 900</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Manila+2006">Manila 2006</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3362">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3362>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3362">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
