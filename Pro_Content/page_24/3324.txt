<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3324 -- Lucas-Lehmer Test</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3324></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3324&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Lucas-Lehmer Test</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 10000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 770</td><td width="10px"></td><td><b>Accepted:</b> 171</td></tr><tr><td colspan="3" align="center" style="color:#0ead00"><b>Case Time Limit:</b> 6000MS</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In mathematics, the Lucas-Lehmer test is a primality test for Mersenne numbers (numbers of the form 2<i><sup>n</sup></i> &minus; 1). The test was originally developed by Edouard Lucas in 1856, and subsequently improved by Lucas in 1878 and Derrick Henry Lehmer in the 1930s. The well-known distributed computing project Great Internet Mersenne Prime Search (GIMPS) uses the test to locate Mersenne primes (Mersenne numbers that are also prime numbers). As of the time when this problem is composed, the largest known Mersenne prime is 2<sup>32,382,657</sup> &minus; 1, which was discovered on September 4, 2006 by Curtis Cooper and Steven Boone.</p><p>The test works as follows. Let <i>M<sub>p</sub></i> = 2<i><sup>p</sup></i> &minus; 1 be the Mersenne number to test with <i>p</i> a positive integer (in real applications only large primes are of interest since primality of <i>M<sub>p</sub></i> is easy to determine when <i>p</i> is relatively small and if <i>p</i> is composite, so is <i>M<sub>p</sub></i>). Define a sequence {<i>s<sub>i</sub></i>} for all <i>i</i> &ge; 0 by</p><blockquote><p><i>s</i><sub>0</sub> = 4;<br><i>s<sub>i</sub></i> = <i>s</i><sup>2</sup><sub><i>i</i> &minus; 1</sub> &minus; 2 for all <i>i</i> &gt; 0.</p></blockquote><p>Then <i>M<sub>p</sub></i> is prime iff</p><blockquote><p><i>s<sub>p</sub></i><sub> &minus; 2</sub> &equiv; 0 (mod <i>M<sub>p</sub></i>).</p></blockquote><p>The number <i>s<sub>p</sub></i><sub> &minus; 2</sub> mod <i>M<sub>p</sub></i> is called the <b>Lucas-Lehmer residue</b> of <i>p</i>.</p><p>Your task is to write a simple implementation of the Lucas-Lehmer test.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains one or more positive integers below 8,192 which are <i>not</i> necessarily primes, one on a each line. End-of-file (EOF) indicates the end of input.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each integer in the input, output its Lucas-Lehmer residue in hexadecimal using digits <code>0</code> through <code>9</code> and lowercase letters <code>a</code> through <code>f</code>, each on a separate line.</p></div><p class="pst">Sample Input</p><pre class="sio">59
61</pre><p class="pst">Sample Output</p><pre class="sio">64099e5fcbcaf36
0</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=POJ+Monthly--2007.08.05">POJ Monthly--2007.08.05</a>, frkstyc</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3324">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3324>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3324">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
