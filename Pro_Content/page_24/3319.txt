<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3319 -- Dragon Slayer Qualification Exam</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3319></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3319&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Dragon Slayer Qualification Exam</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 819</td><td width="10px"></td><td><b>Accepted:</b> 158</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>You might think that Earth is the only planet where life is going on, but it is not true. About 880,228 light years away from Earth, there is a big planet, Haden, where another kind of human beings exists.</p><p>Unfortunately, there is another creature living on Haden: a dragon. This dragon attacks villages to find food whenever it gets hungry. People are getting sick of being attacked and being harmed. Now, they decided to select one strong dragon slayer to kill the dragon. </p><p>As one of human beings living on Haden, you've seen a lot of disasters caused by the dragon and you want to become a good dragon slayer. Here's the first task that you are given:</p><p>You have an <i>n</i> by <i>n</i> chess board where <i>n</i> is even. This chess board looks regular except that it has a couple of red cells and yellow cells, not only black and/or white. You are going to place many of white rooks and/or black rooks on the chess board. Here are the rules:</p><ul><li>Each cell has a color of black, white, yellow, or red</li><li>You cannot place any rooks on yellow cells</li><li>You must place one rook (either black or white, your choice) on each red cell</li><li>You may not place a black rook on a black cell</li><li>You may not place a white rook on a white cell</li><li>There should be no pair of two rooks with the same color that can attack each other. If two rooks with the same color are placed on the same row OR same column, they can attack each other.</li><li>You must maximize the total number of rooks that you place on the board</li></ul><p>Let's take a look at following examples. </p><p><center><img src = "images/3319_1.GIF"> </img><img src = "images/3319_2.GIF"></img></center></p><p>On the left 6 by 6 chess board, you can place 6 black rooks and 6 white rooks as indicated as small circles. On the right board, it is a bit more complicated due to two red cells, but you can safely place the same number of rooks here, too. Since you can never place more than 2<i>n</i> rooks (<i>n</i> white rooks and <i>n</i> black rooks), this is the maximum number of rooks that you can place without violating any rules. Note that both examples don't have any yellow cells. Let's write a program to solve this task so that you can advance to the next round! </p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>A test set can have several test cases, and the number of test cases is given at the first line. Each test case starts with three integers, <i>n</i>, <i>m</i>, and <i>k</i> where <i>n</i> tells you the size of a chess board, <i>m</i> is the number of red cells on the board, and <i>k</i> is the number of yellow cells. Each of following <i>m</i> lines contains two integers (row number and column number, 0-based), representing a red cell on the board. Then, each of following <i>k</i> lines contains two integers, representing a yellow cell on the board. See the sample input for clarification. You may assume that any cell cannot be both yellow and red and that the same cell is not given more than once. For each test case, <i>n</i>, <i>m</i>, and <i>k</i> do not exceed 40, 10, and 1600, respectively.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US">For each test case, output only one integer, the maximum possible number of rooks that you can place. If such placement doesn't exist, output 0.<br></div><p class="pst">Sample Input</p><pre class="sio">4
6 0 0
6 2 0
2 1
5 5
2 0 2
0 0
0 1
2 3 1
0 0
0 1
1 1
1 0
</pre><p class="pst">Sample Output</p><pre class="sio">12
12
2
3
</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">It does not matter whether the left-top cell is black or white in this problem. However, if you want, here is a simple, nice way to determine the color of each cell: Cell (<i>r</i>, <i>c</i>) is white if and only if it is neither yellow nor red and <i>r</i>+<i>c</i> is odd. Cell (<i>r</i>, <i>c</i>) is black if and only if it is neither yellow nor red and <i>r</i>+<i>c</i> is even. Here, (<i>r</i>, <i>c</i>) means that the cell is on the <i>r</i>-th row and on the <i>c</i>-th column.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=POJ+Monthly--2007.08.05">POJ Monthly--2007.08.05</a>, Hooyeon Lee (ltdtl@POJ), "I like dragons"</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3319">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3319>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3319">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
