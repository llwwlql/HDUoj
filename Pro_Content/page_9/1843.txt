<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>1843 -- Shire</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=1843></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=1843&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Shire</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 30000K</td></tr><tr><td><b>Total Submissions:</b> 119</td><td width="10px"></td><td><b>Accepted:</b> 18</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">All the peoples living on Earth have decided that the hobbits, the keepers of the Ring of Power should be isolated in a region of the earth named Shire. The boundaries of the shire are represented by a convex polygon with a guard tower in each vertex. <br><br>The positions of all the towers from the region (two unsigned integers referring to a rectangular axis system) are given. A guard on a white horse is watching the shire's boundaries going over all the distances between two successive towers, one after the other, walking on a minimum way, only on paths parallel with the axis of the axis system.<br><br>The maximum length of the road that can be covered by the guard at a complete tour of the shire's boundaries is known and you are asked to determine a polygon with a maximum number of towers per outline, polygon that can be the boundary of the shire. Besides, the boundary has to contain the tower of Mordor (coordinates 0,0) on a vertex, in each of the other vertices being one of the existing towers.<br><center><img src=images/1843_1.jpg></center><br>For example, for the towers location drawn in the figure above and for the 25 km limit of a tower made by a guard, the boundary of the shire can be made, in this order, from the towers of the following coordinates (0,0), (4,1), (8,3), (4,4), (1,4), (0,0). It can be observed that the polygon determined by these towers it's a convex polygon with 5 towers per outline.<br><br>The polygon with  (0,0), (4,1), (4,12), (0,7), (0,0) has itself 5 towers per outline, but a complete tour of this polygon is over 25 km.<br><br>We should pay attention to the following observations:<br>•	There can be towers strictly inside the polygon, but these are not taken into consideration for the maximum criterion;<br>•	The degenerate polygon made only from one top (Mordor) or made from two towers (Mordor and another tower) or more collinear vertices it is considered a solution too;<br>•	There can be collinear towers on the determined polygon's outline;<br>•	In the input there are not two towers whose positions coincide and there is not a tower in the position (0,0).<br></div><p class="pst">Input</p><div class="ptx" lang="en-US">The input has the fllowing structure:<br>N<br>x1 y1<br>x2 y2<br>...<br>xN yN<br>L<br>N is the number of towers in the shire (excepting the implicit tower – Mordor), (x1, y1) ... (xN, yN) are coordinates (abscise, ordinate) of each of the N towers, and L is number representing the maximum length of a complete tour of the polygon.<br>There are some restrictions:<br>•	0 < N <= 50<br>•	0 <= xi, yi <= 200<br>•	0 < L < 1000<br></div><p class="pst">Output</p><div class="ptx" lang="en-US">The output will contain the number of towers on the polygon's outline.</div><p class="pst">Sample Input</p><pre class="sio">9 
0 7
1 4
2 2
4 1
4 4
4 9
8 3
9 9
10 5
25
</pre><p class="pst">Sample Output</p><pre class="sio">5</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Romania+OI+2002">Romania OI 2002</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=1843">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=1843>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=1843">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
