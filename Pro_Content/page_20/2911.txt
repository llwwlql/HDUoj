<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>2911 -- Simplified &lambda;-evaluations</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=2911></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=2911&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Simplified &lambda;-evaluations</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 106</td><td width="10px"></td><td><b>Accepted:</b> 51</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><span lang="en-us"><p>Lambda calculus is the main theoretical core of functional languages. It is based on evaluating <i>&lambda;</i>-expressions.</p><p>A <i>&lambda;</i>-expression is a string of characters consisting either of <i>1)</i> a single constant (for example <i>t</i>), or <i>2)</i> a function definition written as <i>L</i>&lsaquo;<i>var</i>&rsaquo;.&lsaquo;<i>body</i>&rsaquo;, where <i>L</i> denotes , &lsaquo;<i>var</i>&rsaquo; is always some variable (for example <i>x</i>) that can occur in the &lsaquo;<i>body</i>&rsaquo;, which is again some <i>&lambda;</i>-expression, or <i>3)</i> an application of some &lsaquo;<i>function</i>&rsaquo; (for example <i>f</i>) to an &lsaquo;<i>argument</i>&rsaquo; (for example <i>x</i>), in our case written as (<i>f</i>)<i>x</i>, both &lsaquo;<i>function</i>&rsaquo; and &lsaquo;<i>argument</i>&rsaquo; are <i>&lambda;</i>-expressions.</p><p>The occurrences of variable &lsaquo;<i>var</i>1&rsaquo; in an expression <i>E</i> are called bound, if they are inside of the &lsaquo;<i>body</i>&rsaquo; of some sub-expression <i>L</i>&lsaquo;<i>var</i>1&rsaquo;.&lsaquo;<i>body</i>&rsaquo; of <i>E</i>. Variable occurrences that are not bound are called unbound.</p><p>Evaluation of <i>&lambda;</i>-expression results in another <i>&lambda;</i>-expression and is performed using the following rules:</p><ol><li>Constant is evaluated to itself,</li><li>Function definition evaluates to itself,</li><li>Function application (&lsaquo;<i>function</i>&rsaquo;)&lsaquo;<i>argument</i>&rsaquo; is evaluated as follows: first, the &lsaquo;<i>function</i>&rsaquo; is evaluated to <i>L</i>&lsaquo;<i>var</i>&rsaquo;.&lsaquo;<i>body</i>&rsaquo; or something else. In the latter case, the &lsaquo;<i>argument</i>&rsaquo; is evaluated, and the whole function application evaluates to (&lsaquo;<i>evaluated function</i>&rsaquo;)&lsaquo;<i>evaluated argument</i>&rsaquo;. If the &lsaquo;<i>function</i>&rsaquo; evaluates to <i>L</i>&lsaquo;<i>var</i>&rsaquo;.&lsaquo;<i>body</i>&rsaquo;, the &lsaquo;<i>argument</i>&rsaquo; is not evaluated, but all unbound occurrences of variable </i>&lsaquo;<i>var</i>&rsaquo; inside of the expression &lsaquo;<i>body</i>&rsaquo; are directly replaced by (substituted with) the argument &lsaquo;<i>argument</i>&rsaquo;. The result of the whole evaluation of function application is then the evaluated &lsaquo;<i>body</i>&rsaquo;, after the substitution was performed.</li></ol><p>We limit the expressions to contain a single-character lowercase (<i>a</i>&hellip;<i>z</i>) variables and constants only. Sometimes the evaluation never stops. Your program should perform at most 1000 function applications when evaluating any <i>&lambda;</i>-expression. During all evaluation steps, the evaluated <i>&lambda;</i>-expression will not exceed 10000 characters.</p><p>Here are some examples of evaluation of simple <i>&lambda;</i>-expressions (shown in several steps, the text behind <tt>;</tt> is a comment):</p><blockquote><table><tr><td valign="top" colspan="3">1.</td></tr><tr><td valign="top" width="10"></td><td valign="top" width="150"><tt>(Lx.x)y<br>y</tt></td><td valign="top"><tt>; x &lt;- y</tt></td></tr><tr height="20"><td colspan="3"></td></tr><tr><td valign="top" colspan="3">2.</td></tr><tr><td valign="top" width="10"></td><td valign="top" width="150"><tt>(((Lx.Ly.q)Lz.t)r)u<br>((Ly.q)r)u<br>(q)u</tt></td><td valign="top"><tt>; x &lt;- Lz.t<br>; y &lt;- r</tt></td></tr></table></blockquote><p>Note that the scope of the variable next to <i>&lambda;</i> covers only the body of the lambda expression, and the same variable can occur at other places of the expression, for example:</p><blockquote><table><tr><td valign="top" colspan="2">3.</td></tr><tr><td valign="top" width="10"></td><td valign="top" width="150"><tt>((Lx.x)(Ly.y)Lx.x)x<br>((Ly.y)Lx.x)x<br>(Lx.x)x<br>x</tt></td></tr></table></blockquote><p>The body of the <i>&lambda;</i>-expression can contain unbound variables - constants:</p><blockquote><table><tr><td valign="top" colspan="3">4.</td></tr><tr><td valign="top" width="10"></td><td valign="top" width="150"><tt>(((Lx.Ly.q)Lz.t)r)u<br>((Ly.q)r)u<br>q(u)</tt></td><td valign="top"><tt>; x <- Lz.t<br>; y <- r</tt></td></tr></table></blockquote><p>Finally note that our evaluation is simplified as compared to the real <i>&lambda;</i>-calculus: when the argument is substituted for all unbound occurrences of some variable during function application, some of the variable occurrences in the argument that were previously unbound can become bound&hellip; This is normally solved by renaming all the variables in the argument before the function application, and keeping track of correct substitutions. In this problem, you don’t need to take care of this.</p><blockquote><table><tr><td valign="top" colspan="3">5.</td></tr><tr><td valign="top" width="10"></td><td valign="top" width="150"><tt>((Ly.Lx.y)x)w<br>(Lx.x)w<br>w</td><td valign="top"><tt>; y <- x</tt></td></tr></table></blockquote><p>The Department of Programming Languages decided to implement a new functional language. However, they first need a core engine that will evaluate <i>&lambda;</i> -expressions. Write a program that will read a set of expressions from the input file and output their evaluations.</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The input contains set of <i>&lambda;</i>-expressions, one per line. Only the last line contains the expression consisting of a single constant <i>z</i>. You can assume that the input is correct.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The output should contain the result of evaluation of the expressions on the input in the same order as they appear in the input including the last line. If the expression leads to more than 1000 function applications, the line should contain single word &ldquo;<tt>unterminated</tt>&rdquo;.</p></span></div><p class="pst">Sample Input</p><pre class="sio">Lq.q
((Lx.Ly.(x)y)Lz.z)Lq.q
(Lx.x)x
((((Lm.Ln.Lf.Lx.((m)f)((n)f)x)Lo.Lt.(o)t)Lu.Lv.(u)(u)v)a)b
(Lx.(x)x)Lx.(x)x
(q)(Lx.Lx.x)z
z</pre><p class="pst">Sample Output</p><pre class="sio">Lq.q
Lq.q
x
(a)(a)(a)b
unterminated
(q)Lx.x
z</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Svenskt+M%C3%A4sterskap+i+Programmering%2FNorgesmesterskapet+2002">Svenskt Mästerskap i Programmering/Norgesmesterskapet 2002</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=2911">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=2911>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=2911">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
