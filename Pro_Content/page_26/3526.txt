<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3526 -- The Teacher’s Side of Math</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3526></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3526&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">The Teacher’s Side of Math</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 5000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 624</td><td width="10px"></td><td><b>Accepted:</b> 166</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>One of the tasks students routinely carry out in their mathematics classes is to solve a polynomial equation. It is, given a polynomial, say <i>X</i><sup>2</sup> − 4<i>X</i> + 1, to find its roots (2 ± √<span style="text-decoration: overline;">3</span>).</p><p>If the students’ task is to find the roots of a given polynomial, the teacher’s task is then to find a polynomial that has a given root. Ms. Galsone is an enthusiastic mathematics teacher who is bored with finding solutions of quadratic equations that are as simple as <i>a</i> + <i>b</i>√<span style="text-decoration: overline;"><i>c</i></span>. She wanted to make higher-degree equations whose solutions are a little more complicated. As usual in problems in mathematics classes, she wants to maintain all coefficients to be integers and keep the degree of the polynomial as small as possible (provided it has the specified root). Please help her by writing a program that carries out the task of the teacher’s side.</p><p>You are given a number <i>t</i> of the form:</p><p align="center"><i>t</i> = <sup><i>m</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline;"><i>a</i></span> + <sup><i>n</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline"><i>b</i></span></p><p>where <i>a</i> and <i>b</i> are distinct prime numbers, and <i>m</i> and <i>n</i> are integers greater than 1.</p><p>In this problem, you are asked to find <i>t</i>’s <i>minimal polynomial on integers</i>, which is the polynomial <i>F</i>(<i>X</i>) = <i>a<sub>d</sub>X<sup>d</sup></i> + <i>a<sub>d</sub></i><sub>−1</sub><i>X<sup>d</sup></i><sup>−1</sup> + ⋯ + <i>a</i><sub>1</sub><i>X</i> + <i>a</i><sub>0</sub> satisfying the following conditions.</p><ol><li><p>Coefficients <i>a</i><sub>0</sub>, …, <i>a<sub>d</sub></i> are integers and <i>a<sub>d</sub></i> &gt; 0.</p></li><li><p><i>F</i>(<i>t</i>) = 0.</p></li><li><p>The degree <i>d</i> is minimum among polynomials satisfying the above two conditions.</p></li><li><p><i>F</i>(<i>X</i>) is <i>primitive</i>. That is, coefficients <i>a</i><sub>0</sub>, …, <i>a<sub>d</sub></i> have no common divisors greater than one.</p></li></ol><p>For example, the minimal polynomial of √<span style="text-decoration: overline;">3</span> + √<span style="text-decoration: overline">2</span> on integers is <i>F</i>(<i>X</i>) = <i>X</i><sup>4</sup> − 10<i>X</i><sup>2</sup> + 1. Verifying <i>F</i>(<i>t</i>) = 0 is as simple as the following (<i>α</i> = √<span style="text-decoration: overline;">3</span>, <i>β</i> = √<span style="text-decoration: overline">2</span>).</p><div align="center"><table border="0"><tr><td><i>F</i>(<i>t</i>)</td><td>= (<i>α</i> + <i>β</i>)<sup>4</sup> − 10(<i>α</i> + <i>β</i>)<sup>2</sup> + 1</td></tr><tr><td></td><td>= (<i>α</i><sup>4</sup> + 4<i>α</i><sup>3</sup><i>β</i> + 6<i>α</i><sup>2</sup><i>β</i><sup>2</sup> + 4<i>αβ</i><sup>3</sup> + <i>β</i><sup>4</sup>) − 10(<i>α</i><sup>2</sup> + 2<i>αβ</i> + <i>β</i><sup>2</sup>) + 1</td></tr><tr><td></td><td>= 9 + 12<i>αβ</i> + 36 + 8<i>αβ</i> + 1 − 10(3 + 2<i>αβ</i> + 2) + 1</td></tr><tr><td></td><td>= (9 + 36 + 4 − 50 + 1) + (12 + 8 − 20)<i>αβ</i></td></tr><tr><td></td><td>= 0</td></tr></table></div><p>Verifying that the degree of <i>F</i>(<i>t</i>) is in fact minimum is a bit more difficult. Fortunately, under the condition given in this problem, which is that <i>a</i> and <i>b</i> are distinct prime numbers and <i>m</i> and <i>n</i> greater than one, the degree of the minimal polynomial is always <i>mn</i>. Moreover, it is always <i>monic</i>. That is, the coefficient of its highest-order term (<i>a<sub>d</sub></i>) is one.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input consists of multiple datasets, each in the following format.</p><p align="center"><i>a</i> <i>m</i> <i>b</i> <i>n</i></p><p>This line represents <sup><i>m</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline;"><i>a</i></span> + <sup><i>n</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline"><i>b</i></span>. The last dataset is followed by a single line consisting of four zeros. Numbers in a single line are separated by a single space.</p><p>Every dataset satisfies the following conditions.</p><ol><li><p><sup><i>m</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline;"><i>a</i></span> + <sup><i>n</i></sup><span style="margin-left: -0.75ex;">√</span><span style="text-decoration: overline"><i>b</i></span> ≤ 4.</p></li><li><p><i>mn</i> ≤ 20.</p></li><li><p>The coefficients of the answer <i>a</i><sub>0</sub>, …, <i>a<sub>d</sub></i> are between (−2<sup>31</sup> + 1) and (2<sup>31</sup> − 1), inclusive.</p></li></ol></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each dataset, output the coefficients of its minimal polynomial on integers <i>F</i>(<i>X</i>) = <i>a<sub>d</sub>X<sup>d</sup></i> + <i>a<sub>d</sub></i><sub>−1</sub><i>X<sup>d</sup></i><sup>−1</sup> + ⋯ + <i>a</i><sub>1</sub><i>X</i> + <i>a</i><sub>0</sub>, in the following format.</p><p align="center"><i>a<sub>d</sub></i> <i>a<sub>d</sub></i><sub>−1</sub> … <i>a</i><sub>1</sub> <i>a</i><sub>0</sub></p><p>Non-negative integers must be printed without a sign (+ or −). Numbers in a single line must be separated by a single space and no other characters or extra spaces may appear in the output.</p></div><p class="pst">Sample Input</p><pre class="sio">3 2 2 2
3 2 2 3
2 2 3 4
31 4 2 3
3 2 2 7
0 0 0 0</pre><p class="pst">Sample Output</p><pre class="sio">1 0 -10 0 1
1 0 -9 -4 27 -36 -23
1 0 -8 0 18 0 -104 0 1
1 0 0 -8 -93 0 24 -2976 2883 -32 -3720 -23064 -29775
1 0 -21 0 189 0 -945 -4 2835 -252 -5103 -1260 5103 -756 -2183</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Japan+2007">Japan 2007</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3526">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3526>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3526">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
