<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3594 -- Escort of Dr. Who How</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3594></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3594&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Escort of Dr. Who How</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 131072K</td></tr><tr><td><b>Total Submissions:</b> 2635</td><td width="10px"></td><td><b>Accepted:</b> 693</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>The notorious ringleader and cyber-criminal Derek Wu, better known as Dr. Who How, has been convicted for multiple abductions and cyber-frauds several minutes ago. He will soon be transferred from the court to the prison to serve a life sentence. Intelligence from undercover officers in Dr. Who How’s outlawed gang indicates a possible forcible rescue operation by gang members in the case that Dr. Who How is convicted. To ensure a successful escort, besides adopting enhanced security measures, the police force further desires to minimize the escort time—the time that the motorcade of escort has to spend between departure from the court and arrival at the prison.</p><p>The complex traffic condition in the city imposes complications on the police force’s escort effort. While the municipal government has agreed to temporarily shut down a few roads for exclusive police use, the shut-down time windows vary among roads and are generally narrow to avoid excessively disturbing the life of the citizens. The motorcade of escort must pass through any road entirely within its shut-down time window and not use any road that the municipal government has not agreed to shut down.</p><p>Given information about all roads available to the police force for the escort, determine the shortest escort time.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains a single test case. The first line contains four integers <i>n</i>, <i>m</i>, <i>s</i> and <i>t</i> (2 ≤ <i>n</i> ≤ 100; 0 ≤ <i>m</i> ≤ 1000; 1 ≤ <i>s</i>, <i>t</i> ≤ <i>n</i>; <i>s</i> ≠ <i>t</i>). There are <i>n</i> junctions, some pairs of which are connected by <i>m</i> roads. The court and the prison are located at the <i>s</i>-th and the <i>t</i>-th junctions, respectively. The next <i>m</i> lines each contain five integers <i>x</i>, <i>y</i>, <i>b</i>, <i>e</i> and <i>c</i> (1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>; 0 ≤ <i>b</i> &lt; <i>e</i> ≤ 10<sup>4</sup>; 1 ≤ <i>c</i> ≤ 10<sup>4</sup>), indicating that the directed lanes running from the <i>x</i>-th junction to the <i>y</i>-th junction of a road that takes the motorcade of escort <i>c</i> units of time to pass through will be shut down between time <i>b</i> and <i>e</i>. The earliest time when the motorcade can leave the court is time 0.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>If the escort is possible, print the shortest escort time; otherwise, print “<tt>Impossible</tt>”.</p></div><p class="pst">Sample Input</p><pre class="sio">4 5 1 4
1 2 0 1 1
1 2 0 1 2
1 3 1 3 2
2 4 3 4 1
3 4 3 4 1</pre><p class="pst">Sample Output</p><pre class="sio">3</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>The sample is depicted in Figure 1. Each junction is represented by a numbered spot. Each road is represented by an arrow labeled with <img src="formula?tex=%5Clangle%5Clangle+b%2Ce%5Crangle%2Cc%5Crangle" alt="\langle\langle b,e\rangle,c\rangle" align="absmiddle">, its shut-down time window and pass-through time.</p><p align="center"><img src="images/3594_1.png"></p><p align="center">Figure 1: Depiction of the sample</p><p>The second road listed in the sample is virtually unusable for it takes the motorcade of escort longer time to pass through than it can stay available. The remaining four roads enable the following two escort routes:</p><ol><li><img src="formula?tex=1%5Cstackrel%7B%5C%21%5Clangle+0%2C1%5Crangle%7D%7B%5Cto%7D2%5Cstackrel%7B%5C%21%5Clangle+3%2C4%5Crangle%7D%7B%5Cto%7D4" alt="1\stackrel{\!\langle 0,1\rangle}{\to}2\stackrel{\!\langle 3,4\rangle}{\to}4" align="absmiddle"></li><li><img src="formula?tex=1%5Cstackrel%7B%5C%21%5Clangle+1%2C3%5Crangle%7D%7B%5Cto%7D3%5Cstackrel%7B%5C%21%5Clangle+3%2C4%5Crangle%7D%7B%5Cto%7D4" alt="1\stackrel{\!\langle 1,3\rangle}{\to}3\stackrel{\!\langle 3,4\rangle}{\to}4" align="absmiddle"></li></ol><p>(The label <img src="formula?tex=%5Clangle+s%2Ct%5Crangle" alt="\langle s,t\rangle" align="absmiddle"> over an arrow indicates that the motorcade passes through the corresponding road between time <i>s</i> and <i>t</i>.) The first route takes four units of escort time, whereas the second takes three, which is the shortest possible.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=PKU+Campus+2008+%28POJ+Founder+Monthly+Contest+%E2%80%93+2008.05.10%29">PKU Campus 2008 (POJ Founder Monthly Contest – 2008.05.10)</a>, frkstyc</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3594">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3594>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3594">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
