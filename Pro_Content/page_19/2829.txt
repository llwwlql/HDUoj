<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>2829 -- How Many Free Dimensions?</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=2829></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=2829&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">How Many Free Dimensions?</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 123</td><td width="10px"></td><td><b>Accepted:</b> 40</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In calculating the outer product of vectors, existence of constraints usually makes it that not all the components of the product are independent of the others. For example, the outer product of two two-dimensional vectors <b><i>A</i></b> = (<i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>) and <b><i>B</i></b> = (<i>b</i><sub>1</sub>, <i>b</i><sub>2</sub>), <b><i>C</i></b> = <b><i>A</i></b> &times; <b><i>B</i></b> = (<i>c</i><sub>11</sub>, <i>c</i><sub>12</sub>, <i>c</i><sub>21</sub>, <i>c</i><sub>22</sub>). If we set <i>c</i><sub>12</sub> = <i>c</i><sub>21</sub>, then only three of the four components of <b><i>C</i></b> is independent, or <b><i>C</i></b> has three free dimensions.</p><p>Now we have <i>k</i> <i>n</i>-dimensional vectors <b><i>A</i></b><sub>1</sub>, <b><i>A</i></b><sub>2</sub>, &hellip;, <i><b>A</b><sub>k</sub></i>. The product of them is a vector of <i>n<sup>k</sup></i> components <b><i>Z</i></b> = (<i>z<sub>&alpha;</sub></i>) where <i>&alpha;</i> enumerates all possible subscripts <i>i</i><sub>1</sub><i>i</i><sub>2</sub>&hellip;<i>i<sub>k</sub></i> (1 &le; <i>i<sub>j</sub></i> &le; <i>n</i> for all <i>j</i> s.t. 1 &le; <i>j</i> &le; <i>k</i>). We can then apply a rule of constraint of the form <i>s</i><sub>1</sub><i>s</i><sub>2</sub>&hellip;<i>s<sub>k</sub></i>=<i>t</i><sub>1</sub><i>t</i><sub>2</sub>&hellip;<i>t<sub>k</sub></i> to the subscripts. Here <i>s</i><sub>1</sub><i>s</i><sub>2</sub>&hellip;<i>s<sub>k</sub></i> and <i>t</i><sub>1</sub><i>t</i><sub>2</sub>&hellip;<i>t<sub>k</sub></i> are two strings consisting of the same set of lowercase letters. A letter appearing in one string will also appear in the other one and it can have multiple occurrences in a string. When a rule is applied, the letters in it are replaced by arbitrary integers between 1 and <i>n</i> (inclusive) provided that the same letters are replaced by the same integers and different letters are replaced by different integers. If a resulted string after replacements is <i>p</i><sub>1</sub><i>p</i><sub>2</sub>&hellip;<i>p<sub>k</sub></i>=<i>q</i><sub>1</sub><i>q</i><sub>2</sub>&hellip;<i>q<sub>k</sub></i>, let <i>&alpha;</i> be <i>p</i><sub>1</sub><i>p</i><sub>2</sub>&hellip;<i>p<sub>k</sub></i> and <i>&beta;</i> be <i>q</i><sub>1</sub><i>q</i><sub>2</sub>&hellip;<i>q<sub>k</sub></i>, then we set <i>z<sub>&alpha;</sub></i> = <i>z<sub>&beta;</sub></i>. Given the number of vectors and their dimensions and a rule of constraint, you are required to compute the number of free dimensions of the product of the vectors.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains several test cases. Each test case consists of two lines followed by a blank one. On the first line there are two integers which are <i>n</i> and <i>k</i> in the order they appear. On the second line is a rule of constraint. Two zeroes on a separate line follow the last test case.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each test case, output one line containing the number of free dimensions of the product of vectors.</p></div><p class="pst">Sample Input</p><pre class="sio">2 2
ij=ji

3 3
iij=jii

0 0</pre><p class="pst">Sample Output</p><pre class="sio">3
21</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>In the second test case in the sample input, the rule <i>iij</i>=<i>jii</i> represents the constraints <i>z</i><sub>112</sub> = <i>z</i><sub>211</sub>, <i>z</i><sub>113</sub> = <i>z</i><sub>311</sub>, <i>z</i><sub>221</sub> = <i>z</i><sub>122</sub>, <i>z</i><sub>223</sub> = <i>z</i><sub>322</sub>, <i>z</i><sub>331</sub> = <i>z</i><sub>133</sub> and <i>z</i><sub>332</sub> = <i>z</i><sub>233</sub>.</p><p>You can safely assume that all calculations can be done with 64-bit integers.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=POJ+Monthly--2006.05.28">POJ Monthly--2006.05.28</a>, Liang, Shaochi</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=2829">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=2829>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=2829">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
