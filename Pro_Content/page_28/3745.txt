<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3745 -- Keep Contact</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3745></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3745&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Keep Contact</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 3000MS</td><td width="10px"></td><td colspan="3"><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 207</td><td width="10px"></td><td><b>Accepted:</b> 13</td><td width="10px"></td><td style="font-weight:bold; color:red;">Special Judge</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><div><p>This is a story from <i>Death Note</i>.</p><p>L has determined to find Killa out. Because Killa is a dangerous and cruel guy, L has to make a perfect plan. He has founded a team consisting of n detectives (include himself) to investigate Killa. These guys are extremely trusty, intelligent and cagey. So they won't be easily killed by Killa.</p><p>Moreover, m assistants are assigned to help L. Each of them is responsible to transporting information from one detective to another and only in this direction. These guys are also trusty and cagey, but not intelligent enough, so they may be easily killed and the information may be stolen by Killa. So L has a better plan.</p><p>Every time L has an instruction which he wants to inform all the detectives. He encodes the instruction and assigns some assistants to deliver the encoded instruction to the detectives they are responsible to contact. Then the detectives who receive the encoded instruction will deliver the instruction to other detectives in the same way. As we want to reduced the possibility of assistants’ being killed, we will always try to use least assistants to make all the detective receive the encoded instruction.</p><p>At the same time L will inform the way to decode the instruction to all the detectives in the same way. Of course L doesn’t want Killa to know their plan, so no assistants will be assigned to deliver the encoded instruction and the way to decode it at same time.</p><p>L believes that Killa can track and kill no more than one person at one time, so he believes that this plan is perfect. And L can directly get information from his detectives via some magical measure and you needn't worry about the feedback of the instruction.</p><p>The task for you is to select the assistants to deliver the encoded instruction and the way to decode it, or tell L that no valid schemes exist.</p></div></div><p class="pst">Input</p><div class="ptx" lang="en-US">The input consists of several test cases.<br>Each test case starts with two integers n(2≤n≤2,000) and m(1≤m≤1,000,000), representing the number of detectives and assistants, followed by n lines. The ith line describes the assistants who works for detective i . In the ith line , an integer k comes first , presenting the number of assistants who works detective i , then there are k integers . The jth number x means this assistant is assigned to transport message from detective i to detective x . <br>For the detectives, L is numbered 1 and other detectives are numbered 2 to n.<br>For the assistants , they are numbered from 1 to m by the order they appeared in the input file.<br>A case with n = 0 and m = 0 indicates the end of the input file, and should not be processed by your program.. <br>You can assume that the input file is valid , which means there are exactly m assistants appearing in each test case<br></div><p class="pst">Output</p><div class="ptx" lang="en-US">For each test case:<br>If no valid schemes exist, the output consists of a single line with a single word NONE.<br>Otherwise the output consists of two lines. The first line consists of a single word YES. Each line of the next two lines describes a valid scheme for one part of the message by giving the list of contacts used to transport it, the second line for the encoded instruction and the third line for the way to decode it. If there is more than one solution, output any of them.<br>Output a blank line after each test case.<br></div><p class="pst">Sample Input</p><pre class="sio">4 6
2 2 3
3 3 4 4
1 2
0
0 0
</pre><p class="pst">Sample Output</p><pre class="sio">YES
1 3 4
2 5 6
</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=POJ+Monthly+Contest+-+2009.08.23">POJ Monthly Contest - 2009.08.23</a>, Elaxia</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3745">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3745>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3745">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
