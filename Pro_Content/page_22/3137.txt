<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3137 -- Enjoyable Commutation</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3137></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3137&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Enjoyable Commutation</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 5000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 963</td><td width="10px"></td><td><b>Accepted:</b> 262</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>Isaac is tired of his daily trip to his office, using the same shortest route everyday. Although this saves his time, he must see the same scenery again and again. He cannot stand such a boring commutation any more.</p><p>One day, he decided to improve the situation. He would change his route everyday at least slightly. His new scheme is as follows. On the first day, he uses the shortest route. On the second day, he uses the second shortest route, namely the shortest except one used on the first day. In general, on the <i>k</i>-th day, the <i>k</i>-th shortest route is chosen. Visiting the same place twice on a route should be avoided, of course.</p><p>You are invited to help Isaac, by writing a program which finds his route on the <i>k</i>-th day. The problem is easily modeled using terms in the graph theory. Your program should find the <i>k</i>-th shortest path in the given directed graph.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The input consists of multiple datasets, each in the following format.</p><blockquote><table border="0" width="200"><tr><td width="20%"><i>n</i></td><td width="20%"><i>m</i></td><td width="20%"><i>k</i></td><td width="20%"><i>a</i></td><td width="20%"><i>b</i></td></tr><tr><td width="20%"><i>x</i><sub>1</sub></td><td width="20%"><i>y</i><sub>1</sub></td><td width="20%"><i>d</i><sub>1</sub></td><td width="40%" colspan="2" rowspan="4"></td></tr><tr><td width="20%"><i>x</i><sub>2</sub></td><td width="20%"><i>y</i><sub>2</sub></td><td width="20%"><i>d</i><sub>2</sub></td></tr><tr><td width="60%" colspan="3"><p align="center">&hellip;</td></tr><tr><td width="20%"><i>x<sub>m</sub></i></td><td width="20%"><i>y<sub>m</sub></i></td><td width="20%"><i>d<sub>m</sub></i></td></tr></table></blockquote><p>Every input item in a dataset is a non-negative integer. Two or more input items in a line are separated by a space.</p><p><i>n</i> is the number of nodes in the graph. You can assume the inequality 2 &le; <i>n</i> &le; 50. <i>m</i> is the number of (directed) edges. <i>a</i> is the start node, and <i>b</i> is the goal node. They are between 1 and <i>n</i>, inclusive. You are required to find the <i>k</i>-th shortest path from <i>a</i> to <i>b</i>. You can assume 1 &le; <i>k</i> &le; 200 and <i>a</i> &ne; <i>b</i>.</p><p>The <i>i</i>-th edge is from the node <i>x<sub>i</sub></i> to <i>y<sub>i</sub></i> with the length <i>d<sub>i</sub></i> (1 &le; <i>i</i> &le; <i>m</i>). Both <i>x<sub>i</sub></i> and <i>y<sub>i</sub></i> are between 1 and <i>n</i>, inclusive. <i>d<sub>i</sub></i> is between 1 and 10000, inclusive. You can directly go from <i>x<sub>i</sub></i> to <i>y<sub>i</sub></i>, but not from <i>y<sub>i</sub></i> to <i>x<sub>i</sub></i> unless an edge from <i>y<sub>i</sub></i> to <i>x<sub>i</sub></i> is explicitly given. The edge connecting the same pair of nodes is unique, if any, that is, if <i>i</i> &ne; <i>j</i>, it is never the case that <i>x<sub>i</sub></i> equals <i>x<sub>j</sub></i> and <i>y<sub>i</sub></i> equals <i>y<sub>j</sub></i>. Edges are not connecting a node to itself, that is, <i>x<sub>i</sub></i> never equals <i>y<sub>i</sub></i>. Thus the inequality 0 &le; <i>m</i> &le; <i>n</i>(<i>n</i> &minus; 1) holds.</p><p>Note that the given graph may be quite unrealistic as a road network. Both the cases <i>m</i> = 0 and <i>m</i> = <i>n</i>(<i>n</i> &minus; 1) are included in the judges&rsquo; data.</p><p>The last dataset is followed by a line containing five zeros (separated by a space).</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><span lang="en-us"><p>For each dataset in the input, one line should be output as specified below. An output line should not contain extra characters such as spaces.</p><p>If the number of distinct paths from <i>a</i> to <i>b</i> is less than <i>k</i>, the string <code>None</code> should be printed. Note that the first letter of <code>None</code> is in uppercase, while the other letters are in lowercase.</p><p>If the number of distinct paths from <i>a</i> to <i>b</i> is <i>k</i> or more, the node numbers visited in the <i>k</i>-th shortest path should be printed in the visited order, separated by a hyphen (minus sign). Note that <i>a</i> must be the first, and i must be the last in the printed line.</p><p>In this problem the term <i>shorter</i> (thus <i>shortest</i> also) has a special meaning. A path <i>P</i> is defined to be shorter than <i>Q</i>, if and only if one of the following conditions holds.</p><ol><li>The length of <i>P</i> is less than the length of <i>Q</i>. The length of a path is defined to be the sum of lengths of edges on the path.</li><li>The length of <i>P</i> is equal to the length of <i>Q</i>, and <i>P</i>&rsquo;s sequence of node numbers comes earlier than <i>Q</i>&rsquo;s in the dictionary order. Let&rsquo;s specify the latter condition more precisely. Denote <i>P</i>&rsquo;s sequence of node numbers by <i>p</i><sub>1</sub>, <i>p</i><sub>2</sub>, &hellip;, <i>p<sub>s</sub></i>, and <i>Q</i>&rsquo;s by <i>q</i><sub>1</sub>, <i>q</i><sub>2</sub>, &hellip;, <i>q<sub>t</sub></i>. <i>p</i><sub>1</sub> = <i>q</i><sub>1</sub> = <i>a</i> and <i>p<sub>s</sub></i> = <i>q<sub>t</sub></i> = <i>b</i> should be observed. The sequence <i>P</i> comes earlier than <i>Q</i> in the dictionary order, if for some <i>r</i> (1 &le; <i>r</i> &le; <i>s</i> and <i>r</i> &le; <i>t</i>), <i>p</i><sub>1</sub> = <i>q</i><sub>1</sub>, &hellip;, <i>p<sub>r</sub></i><sub> &minus; 1</sub> = <i>q<sub>r</sub></i><sub> &minus; 1</sub>, and <i>p<sub>r</sub></i> &lt; <i>q<sub>r</sub></i> (<i>p<sub>r</sub></i> is numerically smaller than <i>q<sub>r</sub></i>).</li></ol><p>A path visiting the same node twice or more is not allowed.</p></span></div><p class="pst">Sample Input</p><pre class="sio">5 20 10 1 5
1 2 1
1 3 2
1 4 1
1 5 3
2 1 1
2 3 1
2 4 2
2 5 2
3 1 1
3 2 2
3 4 1
3 5 1
4 1 1
4 2 1
4 3 1
4 5 2
5 1 1
5 2 1
5 3 1
5 4 1
4 6 1 1 4
2 4 2
1 3 2
1 2 1
1 4 3
2 3 1
3 4 1
3 3 5 1 3
1 2 1
2 3 1
1 3 1
0 0 0 0 0</pre><p class="pst">Sample Output</p><pre class="sio">1-2-4-3-5
1-2-3-4
None</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>In the case of the first dataset, there are 16 paths from the node 1 to 5. They are ordered as follows (The number in parentheses is the length of the path).</p><blockquote><table width="500"><tr><td align="right" width="7%">1</td><td align="center" width="7%">(3)</td><td width="36%">1-2-3-5</td><td align="right" width="7%">9</td><td align="center" width="7%">(5)</td><td width="36%">1-2-3-4-5</td></tr><tr><td align="right" width="7%">2</td><td align="center" width="7%">(3)</td><td width="36%">1-2-5</td><td align="right" width="7%">10</td><td align="center" width="7%">(5)</td><td width="36%">1-2-4-3-5</td></tr><tr><td align="right" width="7%">3</td><td align="center" width="7%">(3)</td><td width="36%">1-3-5</td><td align="right" width="7%">11</td><td align="center" width="7%">(5)</td><td width="36%">1-2-4-5</td></tr><tr><td align="right" width="7%">4</td><td align="center" width="7%">(3)</td><td width="36%">1-4-3-5</td><td align="right" width="7%">12</td><td align="center" width="7%">(5)</td><td width="36%">1-3-4-5</td></tr><tr><td align="right" width="7%">5</td><td align="center" width="7%">(3)</td><td width="36%">1-4-5</td><td align="right" width="7%">13</td><td align="center" width="7%">(6)</td><td width="36%">1-3-2-5</td></tr><tr><td align="right" width="7%">6</td><td align="center" width="7%">(3)</td><td width="36%">1-5</td><td align="right" width="7%">14</td><td align="center" width="7%">(6)</td><td width="36%">1-3-4-2-5</td></tr><tr><td align="right" width="7%">7</td><td align="center" width="7%">(4)</td><td width="36%">1-4-2-3-5</td><td align="right" width="7%">15</td><td align="center" width="7%">(6)</td><td width="36%">1-4-3-2-5</td></tr><tr><td align="right" width="7%">8</td><td align="center" width="7%">(4)</td><td width="36%">1-4-2-5</td><td align="right" width="7%">16</td><td align="center" width="7%">(8)</td><td width="36%">1-3-2-4-5</td></tr></table></blockquote></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Japan+2006">Japan 2006</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3137">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3137>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3137">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
