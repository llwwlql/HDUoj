<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3195 -- Generalized Matrioshkas</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3195></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3195&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Generalized Matrioshkas</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 1844</td><td width="10px"></td><td><b>Accepted:</b> 544</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><span lang="en-us"><p>Vladimir worked for years making matrioshkas, those nesting dolls that certainly represent truly Russian craft. A matrioshka is a doll that may be opened in two halves, so that one finds another doll inside. Then this doll may be opened to find another one inside it. This can be repeated several times, till a final doll &ndash; that cannot be opened &ndash; is reached.</p><p>Recently, Vladimir realized that the idea of nesting dolls might be generalized to nesting toys. Indeed, he has designed toys that contain toys but in a more general sense. One of these toys may be opened in two halves and it may have more than one toy inside it. That is the new feature that Vladimir wants to introduce in his new line of toys.</p><p>Vladimir has developed a notation to describe how nesting toys should be constructed. A toy is represented with a positive integer, according to its size. More precisely: if when opening the toy represented by <i> m</i> we find the toys represented by <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, &hellip;, <i>n<sub>r</sub></i>, it must be true that <i>n</i><sub>1</sub> + <i>n</i><sub>2</sub> + &hellip; + <i>n<sub>r</sub></i> &lt; <i>m</i>. And if this is the case, we say that toy m contains directly the toys <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, &hellip;, <i>n<sub>r</sub></i>. It should be clear that toys that may be contained in any of the toys <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, &hellip;, <i>n<sub>r</sub></i> are not considered as directly contained in the toy <i>m</i>.</p><p>A <i>generalized matrioshka</i> is denoted with a non-empty sequence of non zero integers of the form:</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td width="32" align="center"><i>a</i><sub>1</sub></td><td width="32" align="center"><i>a</i><sub>2</sub></td><td width="32" align="center"><span lang="en-us">&hellip;</span></td><td width="32" align="center"><i>a<sub>N</sub></i></td></tr></table></div><p>such that toy <i>k</i> is represented in the sequence with two integers &minus;<i>k</i> and <i>k</i>, with the negative one occurring in the sequence first that the positive one.</p><p>For example, the sequence</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">&minus;9</td><td align="center" width="32">&minus;7</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">&minus;3</td><td align="center" width="32">&minus;2</td><td align="center" width="32">&minus;1</td><td align="center" width="32">1</td><td align="center" width="32">2</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>represents a generalized matrioshka conformed by six toys, namely, 1, 2 (twice), 3, 7 and 9. Note that toy 7 contains directly toys 2 and 3. Note that the first copy of toy 2 occurs left from the second one and that the second copy contains directly a toy 1. It would be wrong to understand that the first &minus;2 and the last 2 should be paired.</p><p>On the other hand, the following sequences do not describe generalized matrioshkas:</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">&minus;9</td><td align="center" width="32">&minus;7</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">&minus;3</td><td align="center" width="32">&minus;1</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">1</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>because toy 2 is bigger than toy 1 and cannot be allocated inside it.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">&minus;9</td><td align="center" width="32">&minus;7</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">&minus;3</td><td align="center" width="32">&minus;2</td><td align="center" width="32">&minus;1</td><td align="center" width="32">1</td><td align="center" width="32">2</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">9</td></tr></table></div><p>because 7 and 2 may not be allocated together inside 9.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">&minus;9</td><td align="center" width="32">&minus;7</td><td align="center" width="32">&minus;2</td><td align="center" width="32">2</td><td align="center" width="32">&minus;3</td><td align="center" width="32">&minus;1</td><td align="center" width="32">&minus;2</td><td align="center" width="32">3</td><td align="center" width="32">2</td><td align="center" width="32">1</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>because there is a nesting problem within toy 3.</p><p>Your problem is to write a program to help Vladimir telling good designs from bad ones.</p></span></font></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input file contains several test cases, each one of them in a separate line. Each test case is a sequence of non zero integers, each one with an absolute value less than 10<sup>7</sup>.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>Output texts for each input case are presented in the same order that input is read.</p><p>For each test case the answer must be a line of the form</p><p><code>:-) Matrioshka!</code></p><p>if the design describes a generalized matrioshka. In other case, the answer should be of the form</p><p><code>:-( Try again.</code></p></div><p class="pst">Sample Input</p><pre class="sio">-9 -7 -2 2 -3 -2 -1 1 2 3 7 9
-9 -7 -2 2 -3 -1 -2 2 1 3 7 9
-9 -7 -2 2 -3 -1 -2 3 2 1 7 9
-100 -50 -6 6 50 100
-100 -50 -6 6 45 100
-10 -5 -2 2 5 -4 -3 3 4 10
-9 -5 -2 2 5 -4 -3 3 4 9</pre><p class="pst">Sample Output</p><pre class="sio">:-) Matrioshka!
:-( Try again.
:-( Try again.
:-) Matrioshka!
:-( Try again.
:-) Matrioshka!
:-( Try again.</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Colombia+2006">Colombia 2006</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3195">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3195>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3195">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
