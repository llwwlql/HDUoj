<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3142 -- Escape Plan</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3142></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3142&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Escape Plan</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 6000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 658</td><td width="10px"></td><td><b>Accepted:</b> 75</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><span lang="en-us"><blockquote><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Without turning his head, Vader snarled through his mask, &ldquo;The Millennium Falcon?&rdquo;</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Piett paused a moment before replying. He would have preferred to avoid that issue. &ldquo;Our tracking scanners are on it now,&rdquo; he responded a bit fearfully.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Vader turned to face the admiral, his towering figure looming over the frightened officer. Piett felt a chill course through his veins, and when the Dark Lord spoke again his voice conveyed an image of the dreadful fate that would be inflicted if his commands were not executed.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>&ldquo;I want that ship,&rdquo; he hissed.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>The ice planet was rapidly shrinking to a point of dim light as the Millennium Falcon sped into space. Soon that planet seemed nothing more than one of the billions of light specks scattered throughout the black void.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>But the Falcon was not alone in its escape into deep space. Rather, it was followed by an Imperial fleet that included the Avenger Star Destroyer and a half-dozen TIE fighter. The fighters moved ahead of the huge, slower-moving Destroyer, and closed in on the fleeing Millennium Falcon.</i></p><p align="right" style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>&mdash; Star Wars, Episode V, the Empire Strikes Back</i></p></blockquote><p>You are driving Millennium Falcon, the fastest starship of the entire galaxy, to escape Imperial pursuit. There are <i>N</i> planet systems, numbered from 0 to <i>N</i> &minus; 1, and some of them are connected by one-way hyperspace tunnels. Some hyperspace tunnels are passable at all times, while others are only available at certain times. Initially you are at the ice planet <i>Hoth</i>, the system numbered 0, at time 0 and you need to get to <i>Sullust</i>, the system numbered <i>N</i> &minus; 1. Since there are <i>K</i> Imperial Star Destroyers following you, and they will also make the jump into the hyperspace to continue the pursuit, you have decided to use the <i>K</i> + 1<sup>th</sup> shortest path from <i>Hoth</i> to <i>Sullust</i> so as to minimize the possibility of being attacked halfway by Imperial starships; furthermore, in order to avoid detection, you do not want to risk staying at a system longer than <i>T</i> seconds.</p><p>Note that multiple shortest paths may require same travel time, and your travel path may not be simple (i.e. you are allowed to visit some systems and use some hyperspace tunnels more than once during your journey).</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>There are multiple test cases in the input file. Each test case starts with four integers <i>N</i>, <i>M</i>, <i>K</i> and <i>T</i>, (1 &le; <i>N</i> &le; 100, 0 &le; <i>M</i> &le; 500, 0 &le; <i>K</i> &le; 9, 0 &le; <i>T</i> &le; 100), the number of planet systems, the number of hyperspace tunnels between them, the pursuing Imperial Star Destroyers, and the maximal allowed time to stay at the same system, respectively. <i>M</i> lines follow, each line describes one of the hyperspace tunnels: four integers <i>U</i>, <i>V</i>, <i>C</i>, and <i>W</i>, (0 &le; <i>U</i>, <i>V</i> &le; <i>N</i> &minus; 1, 1 &le; <i>C</i> &le; 10, 1 &le; <i>W</i> &le; 1000000) meaning there&rsquo;s a tunnel from <i>U</i> to <i>V</i> , traveling through this path requires <i>W</i> seconds and it is only available every <i>C</i> seconds, starting from time 0 (i.e. 0, <i>C</i>, 2 * <i>C</i>, 3 * <i>C</i> &hellip; seconds).</p><p>Two successive inputs are separated by a blank line. <i>N</i> = 0, <i>M</i> = 0, <i>K</i> = 0, <i>T</i> = 0 indicates the end of input and should not be processed by your program.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For every test case, you should output one integer on a separate line, the total time we need to reach <i>Sullust</i> in the format as indicated in the sample output; output <code>-1</code> if no such path can be found.</p></div><p class="pst">Sample Input</p><pre class="sio">5 9 2 2
1 2 5 5
2 4 6 6
0 2 1 8
1 4 4 3
3 0 1 8
1 3 5 10
0 4 4 4
2 3 3 4
3 1 5 10

10 0 0 0

0 0 0 0</pre><p class="pst">Sample Output</p><pre class="sio">Case 1: 28
Case 2: -1</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The 1<sup>st</sup> shortest path in this example is 0 &rarr; 4, with a total travel time of 4 seconds; the 2<sup>nd</sup> shortest path is 0 (Wait 2 seconds) &rarr; 2 (Wait 2 seconds) &rarr; 4, with a total travel time of 18 seconds; the 3<sup>rd</sup> shortest path is 0 (Wait 2 seconds) &rarr; 2 (Wait 2 seconds) &rarr; 3 &rarr; 0 &rarr; 4, with a total travel time of 28 seconds.</p></span></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Shanghai+2006">Shanghai 2006</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3142">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3142>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3142">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
