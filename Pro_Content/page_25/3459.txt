<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3459 -- Projects</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3459></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3459&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Projects</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 812</td><td width="10px"></td><td><b>Accepted:</b> 363</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In a certain week, a company wants to finish <i>m</i> projects. To this end, the company can employ at most <i>n</i> people from the unemployment agency for a period of one week. Each external employee will cost the company <tt>salary</tt> euro, unless the project in which he/she is involved is not completed in time. In that case no payment is due.</p><p>For each project the company knows from experience the probability that the project will be completed within a week, as a function of the number of employees working on it. These probabilities are given as percentages <i>p<sub>ij</sub></i>, where <i>i</i> (with 1 &#8804; <i>i</i> &#8804; <i>m</i>) is the number of the project and <i>j</i> is the number of people working on it. Of course, when nobody is working on a project <i>i</i>, the probability <i>p<sub>i</sub></i><sub>0</sub> is zero percent.</p><p>If project <i>i</i> is indeed finished within a week, the company earns <tt>reward</tt>(<i>i</i>) euro; if it is not ready in time, the company has to pay a fine of <tt>punishment</tt>(<i>i</i>) euro.</p><p>Of course the company wants to maximise its total expected profit<sup>1</sup> at the end of the week by finding the optimal number of external employees to hire, and how to divide them over the projects. The optimal number of employees is the total number of people needed to achieve the maximal expected profit. Your task in this matter is to calculate this optimal number of external employees. Remember that at most <i>n</i> people are available. Furthermore: if a person is employed, he/she works on one and only one project.</p><hr noshade width="30%" align="left" size="1" color="#000000"><p><small><sup>1</sup>Let <i>p</i> (0 &lt; <i>p</i> &lt; 1) be the probability that a job is finished in time, and let <i>E</i><sub>1</sub> be the profit in that case. Furthermore, let <i>E</i><sub>2</sub> be the (negative) profit in case the job is not finished in time. Then the expected profit for this particular job is <i>p</i>&#8901;<i>E</i><sub>1</sub> + (1 &#8722; <i>p</i>)&#8901;<i>E</i><sub>2</sub>.</small></p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains a single number: the number of test cases to follow. Each test case has the following format:</p><ul><li>One line with one integer <i>m</i> with 1 &#8804; <i>m</i> &#8804; 100: the number of projects.</li><li>One line with one integer <i>n</i> with 0 &#8804; <i>n</i> &#8804; 100: the maximal number of available employees.</li><li>One line with one integer salary with 0 &#8804; <tt>salary</tt> &#8804; 1,000: the salary of one employee. Remember that the salary is given in euros.</li><li><i>m</i> lines, each line corresponding to a project <i>i</i>, containing <i>n</i> integers <i>p<sub>i</sub></i><sub>1</sub>, <i>p<sub>i</sub></i><sub>2</sub>, &#8230;, <i>p<sub>in</sub></i> (the percentages, with 0 &#8804; <i>p<sub>i</sub></i><sub>1</sub>, <i>p<sub>i</sub></i><sub>2</sub>, &#8230;, <i>p<sub>in</sub></i> &#8804; 100), followed by two integers corresponding to the <tt>reward</tt> and the <tt>punishment</tt> for project <i>i</i>. All values are separated by single spaces. Both <tt>reward</tt> and <tt>punishment</tt> are given in euros and are between 0 and 100,000 (boundaries included).</li></ul></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For every test case in the input file, the output should contain two lines.</p><ul><li>The first line contains the maximal expected profit in eurocents.</li><li>The second line contains the total number of external employees that must be hired in order to achieve this maximal expected profit. If the maximal expected profit can be achieved by different (total) numbers of employees, then these different numbers must be given in increasing order. Numbers have to be separated by single spaces.</li></ul></div><p class="pst">Sample Input</p><pre class="sio">3
1
4
200
90 100 100 100 2000 0
2
2
100
80 80 2100 500
0 100 1700 500
3
4
100
100 80 80 70 1000 100
100 90 80 90 500 50
100 70 60 50 700 100</pre><p class="pst">Sample Output</p><pre class="sio">162000
1
100000
1 2
190000
3</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=BAPC+2006+Qualification">BAPC 2006 Qualification</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3459">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3459>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3459">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
