<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3457 -- Mineshaft</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3457></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3457&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Mineshaft</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 3000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 65</td><td width="10px"></td><td><b>Accepted:</b> 10</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>A plumber has been hired to build an air pipe through a mineshaft from the bottom to the surface. The mineshaft was built without modern technology, so it winds its way up through the earth. Because it is very time consuming to bring the tools necessary to bend the pipe below the surface, the plumber wants to minimize the number of bends in the pipeline.</p><p>For example, for the mineshaft in the first picture below, the minimal number of bends in a pipeline from the bottom to the surface is two. Different optimal solutions exist, one of which is shown in the second picture. The bullets indicate the bends in the pipeline.</p><div align="center"><img src="images/3457_1.png"></div><p>The two walls of the mineshaft are formed by sequences of straight segments. The numbers of segments in the two sequences may be different. Further, the horizontal distance between the walls of the mineshaft may vary, but is always positive. Both walls start at the same level and end at the same level.</p><p>On the way from the bottom of the mineshaft to the surface, the level (the <i>y</i>-coordinate) increases with every segment of a wall. Hence, the mineshaft does not have horizontal plateaus or &#8216;ceilings&#8217;, and at no point does it go back down again.</p><p>For the purpose of this task, you may assume the diameter of the pipeline to be 0. At no point may the pipeline cross the walls. In order to attach the pipeline firmly to the wall, each segment of the pipeline has to touch the walls at (at least) two different places. However, the bending points of the pipeline are weak. They cannot be used to attach the pipeline to the walls. The end points of the pipeline, though, at the bottom and the top of the mineshaft, may be used to attach a segment to the walls.</p><p>Hence, the solution in the third picture above (also having two bends) is not allowed, because the lowest segment of the pipeline can be attached to the walls at only one place: at the bottom of the right wall.</p><p>The pipeline must start anywhere at the bottom of the mineshaft, and must end anywhere on the imaginary line between the top of the left wall and the top of the right wall. Note, however, that the endpoints of the pipeline may only be used to attach the pipeline, if they touch a wall. In particular, the endpoint at the bottom cannot be attached to any position at the bottom which is not the bottom of a wall.</p><p>Finally, the angle that the pipeline makes at a bending point can take any value satisfying &#8722;180&deg; &lt; <i>&#945;</i> &lt; 180&deg; and (of course) <i>&#945;</i> &#8800; 0.</p><p>Note that sometimes it may be useful to have the pipeline intersect with itself. For example, in the mineshaft below, this is needed to get from the bottom to the top of the mineshaft with only three bends.</p><div align="center"><img src="images/3457_2.png"></div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains a single number: the number of test cases to follow. Each test case has the following format:</p><ul><li><p>One line with one integer <i>N</i><sub>1</sub> (2 &#8804; <i>N</i><sub>1</sub> &#8804; 25): the number of points describing the left wall of the mineshaft.</p></li><li><p><i>N</i><sub>1</sub> lines with the coordinates of the points describing the left wall of the mineshaft, from the bottom to the top. The <i>i</i><sup>th</sup> line contains two integers <i>x<sub>i</sub></i> and <i>y<sub>i</sub></i> (&#8722;1,000 &#8804; <i>x<sub>i</sub></i> &#8804; 1,000 and 0 &#8804; <i>y<sub>i</sub></i> &#8804; 1,000) separated by a single space: the <i>x</i>- and <i>y</i>-coordinate of the point, respectively.</p><p>The <i>y</i>-coordinates are monotonically increasing: <i>y</i><sub>1</sub> &lt; <i>y</i><sub>2</sub> &lt; &#8230; &lt; <i>y</i><sub><i>N</i><sub>1</sub></sub>.</p></li><li><p>One line with one integer <i>N</i><sub>2</sub> (2 &#8804; <i>N</i><sub>2</sub> &#8804; 25): the number of points describing the right wall of the mineshaft.</p></li><li><p><i>N</i><sub>2</sub> lines with the coordinates of the points describing the right wall of the mineshaft, from the bottom to the top. The <i>i</i><sup>th</sup> line contains two integers <i>x&#8242;<sub>i</sub></i> and <i>y&#8242;<sub>i</sub></i> (&#8722;1,000 &#8804; <i>x&#8242;<sub>i</sub></i> &#8804; 1,000 and 0 &#8804; <i>y&#8242;<sub>i</sub></i> &#8804; 1,000) separated by a single space: the <i>x</i>- and <i>y</i>-coordinate of the point, respectively.</p><p>The y-coordinates are monotonically increasing: <i>y&#8242;</i><sub>1</sub> &lt; <i>y&#8242;</i><sub>2</sub> &lt; &#8230; &lt; <i>y&#8242;</i><sub><i>N</i><sub>2</sub></sub>.</p></li></ul><p>We always have <i>x</i><sub>1</sub> &lt; <i>x&#8242;</i><sub>1</sub>, <i>y</i><sub>1</sub> = <i>y&#8242;</i><sub>1</sub>, <i>x<sub>N</i><sub>1</sub></sub> &lt; <i>x&#8242;</i><sub><i>N</i><sub>2</sub></sub>, and <i>y<sub>N</sub></i><sub><sub>1</sub></sub> = <i>y&#8242;</i><sub><i>N</i><sub>2</sub></sub>. The walls described by the sequences of points do not cross or even touch each other.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For every test case in the input file, the output should contain a single number, on a single line: the minimum number of bends in the pipeline to make it from the bottom of the mineshaft to the top, under the conditions from the problem description.</p></div><p class="pst">Sample Input</p><pre class="sio">2
7
4 0
8 2
3 7
5 9
3 12
6 14
4 16
5
7 0
10 2
6 6
10 12
8 16
6
-10 10
-10 20
10 22
5 27
0 37
5 47
8
-8 10
-8 16
3 17
9 19
14 24
18 32
18 40
11 47</pre><p class="pst">Sample Output</p><pre class="sio">2
3</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">These testcases correspond to the pictures in the problem description.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=BAPC+2006+Qualification">BAPC 2006 Qualification</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3457">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3457>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3457">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
