<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3473 -- Stochastic Finite State Automaton</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3473></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3473&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Stochastic Finite State Automaton</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 4000MS</td><td width="10px"></td><td colspan="3"><b>Memory Limit:</b> 131072K</td></tr><tr><td><b>Total Submissions:</b> 94</td><td width="10px"></td><td><b>Accepted:</b> 25</td><td width="10px"></td><td style="font-weight:bold; color:red;">Special Judge</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>The finite state automaton (FSA) is an important model of behavioral investigations in computer science, linguistics as well as many other different areas of study. In theoretical computer science literature, an FSA is typically modeled as a string pattern recognizer described with a quintuple &lt;&#931;, <i>S</i>, <i>s</i><sub>0</sub>, <i>&#948;</i>, <i>F</i>&gt;, where: </p><ul><li>&#931; is the input alphabet (a finite nonempty set of symbols). </li><li><i>S</i> is a finite nonempty set of states. </li><li><i>s</i><sub>0</sub> is an element in <i>S</i> designated as the initial state. </li><li><i>&#948;</i> is a function <i>&#948;</i> : <i>S</i> &times; &#931; &#8594; <i>S</i> known as the transition function. </li><li><i>F</i> is a (possibly empty) subset of <i>S</i> whose elements are designated as the final states. </li></ul><p>An FSA with the above description operates as follows: </p><ul><li>At the beginning, the automaton starts in the initial state <i>s</i><sub>0</sub>. </li><li>The automaton continuously reads symbols from its input, one symbol at a time, and transits between states according to the transition function <i>&#948;</i>. To be specific, let <i>s</i> be the current state and <i>w</i> the symbol just read, the automaton transits to the state given by <i>&#948;</i>(<i>s</i>, <i>w</i>). </li><li>When the automaton reaches the end of the input, if the current state belongs to <i>F</i>, the string consisting sequentially of the symbols read by the automaton is declared accepted, otherwise it is declared rejected. </li></ul><p>We will not delve into further details concerning the FSA but focus on a slightly simplified variant &#8211; the stochastic finite state automaton (SFSA). An SFSA is described with a duple &lt;<b><i>A</i></b>, <b><i>b</i></b>&gt;, where:</p><ul><li><b><i>A</i></b> is an <i>n</i>-by-<i>n</i> nonnegative square matrix.</li><li><b><i>b</i></b> is an <i>n</i>-dimensional nonnegative column vector.</li></ul><p>The automaton assumes the first <i>n</i> positive integers as its states. Unlike a normal FSA, it does not read any symbols and consequently does not have an input alphabet. And its transitions are completely self-determined. Concretely speaking, an SFSA operates as follows:</p><ul><li>At the beginning, the automaton selects randomly a positive integer not exceeding <i>n</i>, <i>i</i>, as the initial state with probability <i>b</i><sub><i>i</i></sub>, the <i>i</i>-th component of <b><i>b</i></b>. (It is required that the components of <b><i>b</i></b> sum to exactly 1.)</li><li>At any stage before the automation halts, let <i>j</i> be the current state, the automaton selects randomly a positive integer not exceeding <i>n</i>, <i>i</i>, with probability <i>a</i><sub><i>ij</i></sub>, the element of <b><i>A</i></b> located in the <i>i</i>-th row and the <i>j</i>-th column, or 0 with probability <img src="formula?tex=%5Ctextstyle+1-%5Csum_%7Bi%3D1%7D%5Ena_%7Bij%7D&driver=1" align="absmiddle">. If the automaton selects 0, it halts immediately, otherwise it transits to state <i>i</i>. (It is required that the sum of elements of every column of <b><i>A</i></b> be not less than or equal to 1.)</li></ul><p>Deriving from the above description, we can draw several implications concerning the SFSA. For instance, observably, the automaton may make an infinite number of transits and never halt, but intuitively, this is very unlikely to occur. Before scrutinizing the behavioral features of the SFSA, it is advisable to first investigate its statistical characteristics, namely, we want to know for each state <i>i</i>, the probability that the automaton decides to halt in that state and, given that automaton halts in that state, the expectation as well as the standard deviation of the number of transitions that have been made.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input consists of a single test case. The first input line contains the number <i>n</i> (1 &#8804; <i>n</i> &#8804; 200) alone. The next <i>n</i> lines each contain <i>n</i> nonnegative numbers, giving the elements of an <i>n</i>-by-<i>n</i> square matrix <b><i>A</i></b> in row-major order. On the last line, there are <i>n</i> nonnegative numbers which are the components of an <i>n</i>-dimensional column vector <b><i>b</i></b> in increasing order of their indices. The sum of elements in every column of <b><i>A</i></b> is <i>strictly less than</i> 1, and the components of <b><i>b</i></b> sum to exactly 1. The duple &lt;<b><i>A</i></b>, <b><i>b</i></b>&gt; constitutes the description of an SFSA.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each state in increasing order of their numerical values, output in order and as accurate as possibly the probability that the automaton decides to halt in that state and, given that automaton halts in that state, the expectation as well as the standard deviation of the number of transitions that have been made. A special checker program that admits an relative error of 10<sup>&#8722;6</sup> is used to verify the output.</p></div><p class="pst">Sample Input</p><pre class="sio">3
0.25 0 0
0.25 0 0
0.25 0 0
1 0 0</pre><p class="pst">Sample Output</p><pre class="sio">0.33333333 0.33333333 0.66666667
0.33333333 1.33333333 0.66666667
0.33333333 1.33333333 0.66666667</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>For a random variable <i>X</i>, Var(<i>X</i>) = E(<i>X</i><sup>2</sup>) &minus; (E(<i>X</i>))<sup>2</sup>.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=POJ+Founder+Monthly+Contest+%E2%80%93+2007.12.30">POJ Founder Monthly Contest â€“ 2007.12.30</a>, frkstyc</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3473">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3473>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3473">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
