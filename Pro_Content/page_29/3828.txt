<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>3828 -- Zombies VS Plants</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=3828></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=3828&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Zombies VS Plants</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 120</td><td width="10px"></td><td><b>Accepted:</b> 22</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">Facer was addicted to a popular game called "Plants VS Zombies". After Facer had completed all missions, he started to play the zombies' role to destroy plants and called the new game "Zombies VS Plants".<br><br>In the game "Zombies VS Plants", there are 3 kinds of zombies: Little Zombie, Adult Zombie and Football player. Different zombies have different price and different "attacking value" indicating the capability to attack, as shown in the table below:<br><br><center><table border="1"><tr><td>Zombie name</td><td>Attacking value</td><td>Price for one (in dollars)</td></tr><tr><td>Little Zombie</td><td>40</td><td>50</td></tr><tr><td>Adult Zombie</td><td>70</td><td>75</td></tr><tr><td>Football player</td><td>200</td><td>100</td></tr></table></center><br><br>Spiders also can destroy the plants. Every spider costs 125 dollars.<br><br>There are 4 kinds of plants: Sunflower, Bean, Magnet and Lettuce. Every plant has a "defending value" indicating it's capability of defense.<br><br>Facer's mission is to destroy ALL the plants in the field. In order to destroy plants, Facer needs to buy zombies or spiders and put them into the field. The plants field can be considered as a 5 x 5 grid (of course 25 cells), as shown in the figure below:<br><br><center><table border="1"><tr><td>(1,1)</td><td>(1,2)</td><td>(1,3)</td><td>(1,4)</td><td>(1,5)</td></tr><tr><td>(2,1)</td><td>(2,2)</td><td>(2,3)</td><td>(2,4)</td><td>(2,5)</td></tr><tr><td>(3,1)</td><td>(3,2)</td><td>(3,3)</td><td>(3,4)</td><td>(3,5)</td></tr><tr><td>(4,1)</td><td>(4,2)</td><td>(4,3)</td><td>(4,4)</td><td>(4,5)</td></tr><tr><td>(5,1)</td><td>(5,2)</td><td>(5,3)</td><td>(5,4)</td><td>(5,5)</td></tr></table></center><br><center>Plants field</center><br><br>There is a plant in every cell. Facer can destroy plants only by two ways:<br><ol><br><li>If Facer puts one or more zombies together into a row of the field, and the sum of those zombies' attacking values is larger than the sum of defending values of the plants in the same row, all plants in that row will be destroyed.</li><br><li>Putting a spider in a cell will destroy the plant in it. But there are some exceptions as shown in the description of plant ``Lettuce" in a table below.</li><br></ol><br><br>Once a zombie is put into the plants field, it dies immediately after destroying the plants. So does a spider. In other words, Facer can use a zombie or a spider only once.<br><br>This is a table describing the features of different kinds of plants:<br><br><center><table border="1"><tr><td>Plant name</td><td>Defending value</td><td>Special features</td></tr><tr><td>Sunflower</td><td>0</td><td>None</td></tr><tr><td>Bean</td><td>100</td><td>None</td></tr><tr><td>Magnet</td><td>0</td><td>A magnet can make the attacking value of the football players in the same row and the adjacent rows become 50. For example, if there is a magnet in row 3, the attacking value of all football players Facer put into row 2, 3 and 4 will become 50.</td></tr><tr><td>Lettuce</td><td>0</td><td>Spiders can't destroy a lettuce and the plants in the eight cells around the lettuce. For example, if there is a lettuce at cell (3,3), spiders can't destroy the lettuce and the plants in (2,2), (2,3), (2,4), (3,2), (3,4), (4,2), (4,3) and (4,4).</td></tr></table></center><br><br>Facer can earn P<sub>1</sub> dollars after destroying a row of plants, and destroying a sunflower will earn extra P2 dollars for him. Facer has P3 dollars but no zombies and no spiders at the begging. Of course Facer can use the money he earned to buy zombies and spiders. Your job is helping Facer to accomplish his mission and keep money as much as possible after the mission.</div><p class="pst">Input</p><div class="ptx" lang="en-US">There are multiple test cases.<br><br>The first line in the input is a integer T indicating the number of test cases. (1 &lt; T &lt;= 400)<br><br><br>For each test case:<br><br>First line contains three integers P<sub>1</sub>, P<sub>2</sub> and P<sub>3</sub> (0 &lt;= P<sub>1</sub>, P<sub>2</sub>, P<sub>3</sub> &lt;= 10000), meaning that Facer earns P<sub>1</sub> dollars after destroying a row of plants and earns P<sub>2</sub> dollars after destroying a sunflower, and Facer has P<sub>3</sub> dollars at the beginning.<br><br>Following are 5 lines describing the plants field by top to bottom order. Each line contains 5 integers, telling what's in the cells of a row, by left to right order. For those 5 integers:<br><br><br>"1" represents a sunflower.<br><br>"2" represents a bean.<br><br>"3" represents a magnet.<br><br>"4" represents a lettuce.</div><p class="pst">Output</p><div class="ptx" lang="en-US">For each test case, output one line containing an integer indicating the maximum amount of dollars Facer can keep after he accomplishes the mission. If Facer can't destroy all the plants, print '-1' instead.</div><p class="pst">Sample Input</p><pre class="sio">2
100 100 10000
2 2 2 2 2
2 3 2 2 2
3 3 4 3 2
2 3 2 2 2
2 2 2 2 2
0 0 0
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2</pre><p class="pst">Sample Output</p><pre class="sio">9025
-1</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Ningbo+2009">Ningbo 2009</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=3828">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=3828>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=3828">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
