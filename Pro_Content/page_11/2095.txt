<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>2095 -- Beth Tableaux</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='bbs'>Web Board</A><BR><A href='./'>Home Page</A><BR><A href='page?id=1000' target=_blank>F.A.Qs</A><BR><a href='chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action=gotoproblem method=get><A href='problemlist'>Problems</A><BR><A href='submit'>Submit Problem</A><BR><A href='status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action=searchuser><a href=register>Register</a><br><a href=modifyuser>Update your info</a><br><a href=userlist>Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href=pastcontests>Past Contests</a><br><a href=contests>Scheduled Contests</a><br><a href=challenge.html target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action=login><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href=register target=_parent>Register</a><input type=hidden name=url value=/problem?id=2095></form></td></TR></TABLE><table border=0 width=100% background=images/table_back.jpg><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=2095&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Beth Tableaux</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 10000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 64000K</td></tr><tr><td><b>Total Submissions:</b> 153</td><td width="10px"></td><td><b>Accepted:</b> 36</td></tr><tr><td style="color:#0ead00"><b>Case Time Limit:</b> 2000MS</td><td width="10px"></td><td style="font-weight:bold; color:red;">Special Judge</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">Your program has to check the validity of a given logical formula. If the formula E is invalid (i.e. evaluates to 0 for some assignment of boolean values to the variables), you'll also have to find such an assignment of values. <br>Usually such tasks are solved just by processing all possible assignments of values to the variables occurring in E; if there are k such variables, this requires considering 2<sup>k</sup> such assignments. Of course, this is almost impossible for large values of k. Besides, this process is much different from the way people usually check (i.e. prove) logical formulae. <br>In this task you are to implement a natural way of checking validity of logical formulae based on the so-called Beth tableaux. This way of checking validity of formulae models to a certain extent the process of finding proofs or contrary instances used by humans, at least, a short rigorous proof can be usually obtained quite immediately from constructed Beth tableaux. <br>Let us fix the syntax of logical formulae considered: <br><li>Constants 1 and 0; <br><li>Variables --- letters from A to Z and from a to z; <br><li>Parentheses --- if E is a formula, then (E) is another; <br><li>Negation --- ￢E is a formula for any formula E; <br><li>Conjunction --- E1∧E2∧ ... ∧En . Note that the conjunction is evaluated from left to right: E1∧E2∧E3 = (E1∧E2)∧E3. <br><li>Disjunction --- E1∨E2∨ ... ∨En . The same remark applies. <br><li>Implication --- E1 => E2 . Unlike the previous two operations it is evaluated from right to left:E1=>E2=>E3 means E1=>(E2 =>E3). <br><li>Equivalence --- E1≡E2≡ ... ≡En . This expression is by definition computed as follows:(E1≡E2)∧(E2≡E3)∧ ... ∧(E<sub>n-1</sub>≡En ). <br>The operations are listed from the highest priority to the lowest. <br>Let us define the principal operation of a compound formula E as the operation in E which is performed last (of course, formulae consisting just of one constant or variable have no principal operation). Also let us suppose that our formula does not contain equivalence operations since we can always replace E1≡E2 with (E1=>E2)∧(E2=>E1). <br>Now we define a Beth tableau to be a table with two columns with some formulae written in them. The order formulae are written in the columns and the number of times a formula appears in a column is irrelevant: we can assume for example that all formulae in a column are different and that they are ordered lexicographically. <br>Informally the left column corresponds to formulae which we want to be true and the right column to those which we want to be false; the whole process can be considered then as an attempt to produce a contrary instance to given formula E. A Beth tableau is said to be contradictory if some formula E* occurs in both columns of this tableau, or if 0 occurs in the left column, or if 1 occurs in the right column. <br>At every step of the process we have a collection of Beth tableaux. We start with a single Beth tableau with empty left column and the right column containing just the given formula E. A step of the process consists in choosing a compound formula C from a non-contradictory Beth tableau from the collection and applying a rule chosen by the principal operation of C and by the column (left or right) in which C is situated. As a result some formulae are added to the left or right columns of this Beth tableau (or both); of course, if these formulae that we want to add are already there the Beth tableau won't change, so in this case we say that the corresponding rule is inapplicable. There are also some rules that make two copies of the original Beth tableau and add some formulae into one of these copies and some other into the second one. In this case we say that the rule is inapplicable if both Beth tableaux thus obtained were already in the collection before applying the rule. <br>The process stops when no rule is applicable. Note that all formulae occurring in all Beth tableaux constructed will be sub-formulae of the original formula, so there are only finitely many Beth tableaux that can be obtained and thus only finitely many collections of Beth tableaux can be obtained. Therefore the process will have to stop at some point. If at this point all Beth tableaux in the collection are contradictory, the original formula E has been proved to be valid. Otherwise if τ is a non-contradictory Beth tableau from the collection, any variable x occurring in E must occur in exactly one column of τ (it cannot occur in both columns since τ is not contradictory; it must occur in at least one column since otherwise a rule would be applicable to the shortest formula in τ containing x). Then let us assign 1 to all the variables from the left column and 0 to the variables from the right column of τ . This would give us a contrary instance to E, i.e. an assignment of values to variables for which our original formula E evaluates to 0. <br>Now let us list all possible rules. It has been already explained that a rule is defined by the principal operation * of a formula C and the column (left or right) in which C was found. We shall label these rules by *l and *r where * is the operation (one of ∧, ∨, => or ￢). If * is binary, we shall assume that C = A * B; otherwise we assume C = ￢A. <br>Let us list the rules that do not increase the number of tableaux (i.e. they just add some formulae to the columns of selected Beth tableau): <br><center><img src=images/2095_1.jpg></center><br>This means the following: for example, if we apply the rule =>r to the formula A=>B in the right column of a Beth tableau, then we have to add formula A to the left column and B to the right column of this tableau. <br>The next rules produce two Beth tableaux from one. A similar notation is used, but two Beth tableaux are shown for each rule: <br><center><img src=images/2095_2.jpg></center><br>These three rules are interpreted as follows: if we apply for example ∨l to the formula A∨B in the left column of a Beth tableau τ, we have to replace τ with two copies of itselfτ' and τ'' , and then add A to the left column of τ' and B to the left column of τ'' . </div><p class="pst">Input</p><div class="ptx" lang="en-US">The only line of input contains the formula represented as a string consisting of tokens '0', '1', 'A'. . . 'Z', 'a'. . . 'z', '(', ')', '~', '&', '|', '=>', '='. The last five tokens stand for ￢, ∧, ∨, => and ≡ respectively. Tokens can be separated by an arbitrary number of spaces. The line will contain at most 1 000 characters. The formula in the file will be syntactically correct. </div><p class="pst">Output</p><div class="ptx" lang="en-US">The output file must contain exactly one line. Output just "true" if the formula is valid or "false" followed by an assignment of variables that invalidates the formula. List the variables in lexicographical order. Adhere to the sample output as strictly as possible. </div><p class="pst">Sample Input</p><pre class="sio">K|~i|t|t|~e|~n</pre><p class="pst">Sample Output</p><pre class="sio">false: K=0, e=1, i=1, n=1, t=0</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="searchproblem?field=source&key=Northeastern+Europe+2004">Northeastern Europe 2004</a>, Northern Subregion</div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="submit?problem_id=2095">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href=problemstatus?problem_id=2095>Status</a>]&nbsp;&nbsp; 
[<a href="bbs?problem_id=2095">Discuss</a>]
</font></p>
<p><img height=30 src=images/home.gif width=40 border=0><font size=3><a href=.>Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href=#top>To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
